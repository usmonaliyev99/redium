{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Introduction","text":"<p>This page is full documentation of Redium package.</p> <p>Redium is high-performance authentication package specifically for API. This secure token-based authentication system like Sanctum, but main difference.</p> <p>Everything is stored in Redis.</p> <ul> <li>No SQL tables.</li> <li>No migrations.</li> </ul>"},{"location":"#summary","title":"\ud83e\udde9 Summary","text":"<ul> <li>API-focused</li> <li>Fast Redis-based token storage</li> <li>Same security model as Sanctum</li> <li>Automatic token expiration powered by Redis</li> <li>Fastest rule management</li> <li>No database queries</li> <li>Revoking tokens</li> </ul>"},{"location":"#requirements","title":"\ud83d\udce6 Requirements","text":"<ul> <li>PHP 8.2+</li> <li>Laravel 10+</li> <li>Redis server</li> </ul>"},{"location":"#why-redium","title":"\u2753 Why Redium?","text":"<p>When I'm new in Laravel, I managed auth with Sanctum.</p> <p>It works good, but I debugged my route, I saw queries which I sent to database. There were few queries but one of them is not mine, I figured out it is Sanctum.</p> <p>When application accept HTTP request, Sanctum takes token from header and checks it from database. Actually I don't like this, I don't know it is good or no. If you know more than me, please text me.</p> <p>Then I researched to set up Sanctum with Redis, I couldn't.</p> <p>Then I know it is not possible after seeing code of Sanctum.</p> <p>After all of that I decided to implement my own, that is my first package for auth. In real word it works very good, but it has mistakes.</p>"},{"location":"#solution","title":"\ud83d\udca1 Solution","text":"<p>Why did I name it Redium?</p> <p>I took idea from Sanctum and Redis, That is why I named it like this . That is why name of package is Redium</p> <p>It does not send any query to database, it stores all data in redis. This increase your application performance.</p>"},{"location":"configuration/","title":"Configuration","text":""},{"location":"configuration/#change-default-connection","title":"\ud83d\udd27 Change default connection","text":"<p>By default, token will be created in 0 database of Redis server.</p> <p>If you want to change database for tokens, you have to create new redis database connection. All redis connections are in your <code>config/database.php</code> file, add new one for example:</p> <pre><code>\n'redis' =&gt; [\n    ...\n    'default' =&gt; [\n        ...\n    ],\n\n   'redium' =&gt; [\n        'url' =&gt; env('REDIS_URL'),\n        'host' =&gt; env('REDIS_HOST', '127.0.0.1'),\n        'username' =&gt; env('REDIS_USERNAME'),\n        'password' =&gt; env('REDIS_PASSWORD'),\n        'port' =&gt; env('REDIS_PORT', '6379'),\n        'database' =&gt; '9',\n        'max_retries' =&gt; env('REDIS_MAX_RETRIES', 3),\n        'backoff_algorithm' =&gt; env('REDIS_BACKOFF_ALGORITHM', 'decorrelated_jitter'),\n        'backoff_base' =&gt; env('REDIS_BACKOFF_BASE', 100),\n        'backoff_cap' =&gt; env('REDIS_BACKOFF_CAP', 1000),\n    ], \n]\n</code></pre> <p>Just copy and paste <code>default</code> connection and change name of it also <code>database</code> option, in this example I use 9 database.</p> <p>After creating connection, you can change Redium connection in <code>config/redium.php</code> file.</p> <pre><code>/*\n|--------------------------------------------------------------------------\n| Redis database\n|--------------------------------------------------------------------------\n|\n| This value is the name of your redis connection in your app/database.php file\n|\n*/\n\n'connection' =&gt; 'redium',\n</code></pre> <p>Then it stores and reads tokens from 9 database.</p>"},{"location":"configuration/#change-default-ttl","title":"\u231b Change default ttl","text":"<p>If you do not give <code>expiresAt</code> during creating token, Redium takes default <code>ttl</code> (Time to Live). If it is null, token won't expire.</p> <p>You can change it, you should put how much minutes token should live in <code>ttl</code> section.</p> <pre><code>/*\n|--------------------------------------------------------------------------\n| Expiration seconds\n|--------------------------------------------------------------------------\n|\n| This value controls the number of minutes until a token will be deleted.\n| This will override any values set in the token's \"expires_at\" attribute.\n|\n| For example: 1440 min is 1 day\n|\n*/\n\n'ttl' =&gt; 1440,\n</code></pre> <p>Good willing, There will be few configs, go ahead.</p>"},{"location":"contact/","title":"Contact","text":"<p>If you have questions, suggestions, or need help, feel free to reach out.</p>"},{"location":"contact/#author","title":"\ud83d\ude80 Author","text":"<ul> <li>GitHub: https://github.com/usmonaliyev99</li> <li>Email: t.usmonaliyev99@gmail.com</li> <li>Telegram: https://t.me/usmonaliyev99</li> </ul>"},{"location":"contact/#reporting-issues","title":"\ud83d\udc1b Reporting Issues","text":"<p>If you encounter bugs, unexpected behavior, or have feature requests, please open an issue on GitHub. You can join telegram group:</p> <p>\ud83d\udc49 Telegram Group</p> <p>\ud83d\udc49 Open issue in GitHub</p>"},{"location":"contact/#contributing","title":"\ud83e\udd1d Contributing","text":"<p>Contributions are welcome! If you want to improve the package, submit a pull request or start a discussion.</p> <p>Thank you for using Redium!</p>"},{"location":"how-it-works/","title":"How it works ?","text":"<p>In this page, I'm going to explain how Redium works. In now days, I'm preparing presentations and images for it.</p> <p>Do not miss news, that is why give star this repository, I will publish this page.</p> <p>Trust it, it is secure and open source ...</p>"},{"location":"installation/","title":"Installation","text":"<p>You can install package via Composer.</p> <pre><code>composer require usmonaliyev/redium\n</code></pre> <p>This is optional, if you want to change default ttl or redis connection, you can publish config file.</p> <pre><code>php artisan vendor:publish --tag=redium-config\n</code></pre> <p>This will create <code>config/redium.php</code> file in your project folder.</p>"},{"location":"quick-start/","title":"Quick start","text":""},{"location":"quick-start/#register-trait","title":"\ud83d\udd17 Register trait","text":"<p>To begin your User model should use the <code>Laravel\\Sanctum\\HasApiTokens</code> trait:</p> <pre><code>use Usmonaliyev\\Redium\\Traits\\HasRediumTokens;\n\nclass User extends Authenticatable\n{\n    use HasRediumTokens, HasFactory, Notifiable;\n\n    protected $fillable = [\n        'id',\n        'name',\n        'email',\n        'password',\n    ];\n}\n</code></pre> <p>You should add <code>id</code> to fillable property, it is important.</p> <p>Please add your columns to <code>fillable</code> that you want to get when you use <code>auth()-&gt;user()</code> or <code>Auth::user()</code>.</p>"},{"location":"quick-start/#register-guard","title":"\ud83d\udee1\ufe0f Register guard","text":"<p>Register redium guard in your <code>config/auth.php</code> file:</p> <pre><code>'guards' =&gt; [\n    'web' =&gt; [\n        'driver' =&gt; 'session',\n        'provider' =&gt; 'users',\n    ],\n    'redium' =&gt; [\n        'driver' =&gt; 'redium',\n        'provider' =&gt; 'users',\n    ],\n],\n</code></pre>"},{"location":"quick-start/#create-new-token","title":"\ud83d\udd11 Create new token","text":"<p>To create new token, you may use <code>createToken</code> method. API tokens are hashed using SHA-256 hashing before being stored in Redis database. You should display <code>plainTextToken</code> value to the user immediately after the token has been created:</p> <p>Before creating token, make sure you have valid Redis server credentials in your <code>.env</code> file.</p> <pre><code>use Illuminate\\Http\\Request;\n\nRoute::post('/create-token', function (Request $request) {\n    $user = User::query()-&gt;first();\n    $token = $user-&gt;createToken('Name for token');\n\n    return ['token' =&gt; $token-&gt;plainTextToken];\n});\n</code></pre>"},{"location":"quick-start/#protect-your-routes","title":"\ud83d\udd10 Protect your routes","text":"<p>Take plain token and send request with <code>Authorization: Bearer $plainTextToken</code> header.</p> <p>To protect routes you should attach the redium authentication guard to your API routes.</p> <pre><code>use Illuminate\\Http\\Request;\n\nRoute::middleware('auth:redium')-&gt;get('/user', function (Request $request) {\n    return $request-&gt;user();\n});\n</code></pre> <p>If you want more, keep going...</p>"},{"location":"usage/","title":"Usage","text":"<p>I'm going to tell you, there are few example and this package similar with Sanctum.</p> <p>That is why you can understand them easily.</p>"},{"location":"usage/#simple-login","title":"\ud83d\udeaa Simple login","text":"<pre><code>use App\\Models\\User;\nuse Illuminate\\Http\\Request;\nuse Illuminate\\Support\\Facades\\Hash;\nuse Illuminate\\Validation\\ValidationException;\n\nRoute::post('/redium/token', function (Request $request) {\n    $request-&gt;validate([\n        'email' =&gt; 'required|email',\n        'password' =&gt; 'required',\n        'device_name' =&gt; 'required',\n    ]);\n\n    $user = User::where('email', $request-&gt;email)-&gt;first();\n\n    if (! $user || ! Hash::check($request-&gt;password, $user-&gt;password)) {\n        throw ValidationException::withMessages([\n            'email' =&gt; ['The provided credentials are incorrect.'],\n        ]);\n    }\n\n    $accesss = $user-&gt;createToken($request-&gt;device_name);\n\n    return response()-&gt;json(['token' =&gt; $access-&gt;plainTextToken]);\n});\n</code></pre>"},{"location":"usage/#token-abilities","title":"\ud83e\udde9 Token abilities","text":"<p>Redium allows you to assign \"abilities\" to tokens.</p> <pre><code>$abilities = ['users.show', 'posts.show', 'employees.show'];\n$accesss = $user-&gt;createToken($request-&gt;device_name, $abilities);\n</code></pre> <p>When handling incoming request authenticated by Redium, you may determine if token has a given ability using the <code>tokenCan</code> or <code>tokenCant</code> methods:</p> <pre><code>if ($user-&gt;tokenCan('users.show')) {\n    // ...\n}\n\nif ($user-&gt;tokenCant('users.delete')) {\n    // ...\n}\n</code></pre>"},{"location":"usage/#sign-out","title":"\ud83d\udc4b Sign out","text":"<p>You can sing out by using <code>delete</code> function of your <code>currentAccessToken</code> function:</p> <pre><code>$user-&gt;currentAccessToken()-&gt;delete();\n</code></pre> <p>It will delete current token from Redis database.</p>"},{"location":"usage/#revoking-tokens","title":"\ud83e\uddf9 Revoking tokens","text":"<p>You may \"revoke\" tokens by deleting them from Redis server using <code>tokens</code> function that is provided by <code>Usmonaliyev\\Redium\\Traits\\HasRediumTokens</code> trait.</p> <pre><code>$tokens = $user-&gt;tokens();\n\narray_map(fn ($token) =&gt; $token-&gt;delete(), $tokens);\n</code></pre> <p>If you want to sign out all sessions, you have to delete them one by one. Maybe one day I will one function for this job.</p>"},{"location":"usage/#protecting-routes","title":"\ud83d\udd10 Protecting routes","text":"<p>We only talked about creating tokens, delete them. Now we see how we can protect our routes:</p> <p>As previously documented, you may protect routes so that all incoming requests must be authenticated by attaching the <code>redium</code> authentication guard to the routes:</p> <pre><code>Route::middleware('auth:redium')-&gt;get('/user', function (Request $request) {\n    return $request-&gt;user();\n});\n</code></pre> <p>If you have a lot of routes, you should use <code>group</code> function of Route class:</p> <pre><code>Route::middleware('auth:redium')-&gt;group(function () {\n    ...\n})\n</code></pre> <p>If error is coming out like \"Auth guard [redium] is not defined.\", go to <code>config/auth.php</code> file and register <code>redium</code> guard.</p>"}]}